# ERCOT Parquet File Catalog

## Overview

This document provides a comprehensive catalog of all Parquet files generated by the annual rollup processor, including their column definitions, data types, and temporal coverage. Note that certain columns were introduced in specific years as ERCOT evolved its data formats.

## Directory Structure
```
/Users/enrico/data/ERCOT_data/rollup_files/
├── RT_prices/           # Real-time prices (15-minute)
├── DA_prices/           # Day-ahead prices (hourly)
├── AS_prices/           # Ancillary services prices
├── DAM_Gen_Resources/   # Day-ahead awards
├── SCED_Gen_Resources/  # Real-time dispatch
├── COP_Snapshots/       # Current operating plans
└── SASM_AS_Offers/      # AS market offers
```

## 1. Real-Time Settlement Point Prices

**Location**: `/rollup_files/RT_prices/`  
**Files**: `2011.parquet` through `2025.parquet`  
**Granularity**: 15-minute intervals  
**Record Count**: ~35M records/year (96 intervals × 365 days × 1000s of points)

### Column Schema
| Column Name | Data Type | Description | Available From |
|------------|-----------|-------------|----------------|
| DeliveryDate | Date | Operating day | 2011 |
| DeliveryHour | Int32 | Hour of day (1-24) | 2011 |
| DeliveryInterval | Int32 | 15-min interval (1-4) | 2011 |
| SettlementPointName | Utf8 | Settlement point identifier | 2011 |
| SettlementPointType | Utf8 | Type (RN, HU, LZ) | 2011 |
| SettlementPointPrice | Float64 | Price in $/MWh | 2011 |
| DSTFlag | Utf8 | Daylight saving indicator | 2011 |
| datetime | Datetime | Computed timestamp | All |

### Notes
- DSTFlag column added in 2011 for DST handling
- SettlementPointPrice forced to Float64 to prevent type mismatches
- Includes scarcity adders in price (critical for BESS revenue)

## 2. Day-Ahead Market Settlement Point Prices

**Location**: `/rollup_files/DA_prices/`  
**Files**: `2010.parquet` through `2025.parquet`  
**Granularity**: Hourly  
**Record Count**: ~8.7M records/year (24 hours × 365 days × 1000s of points)

### Column Schema
| Column Name | Data Type | Description | Available From |
|------------|-----------|-------------|----------------|
| DeliveryDate | Date | Operating day | 2010 |
| HourEnding | Utf8 | Hour ending time | 2010 |
| SettlementPoint | Utf8 | Settlement point name | 2010 |
| SettlementPointPrice | Float64 | DAM price in $/MWh | 2010 |
| DSTFlag | Utf8 | Daylight saving flag | 2011 |
| datetime | Datetime | Computed timestamp | All |

### Notes
- HourEnding changed from Int64 to Utf8 in some years
- Pre-2011 files may lack DSTFlag (defaulted to 'N')

## 3. Ancillary Services Clearing Prices

**Location**: `/rollup_files/AS_prices/`  
**Files**: `2010.parquet` through `2025.parquet`  
**Granularity**: Hourly by service type  
**Record Count**: ~200K records/year (24 hours × 365 days × 5-7 service types)

### Column Schema
| Column Name | Data Type | Description | Available From |
|------------|-----------|-------------|----------------|
| DeliveryDate | Date | Operating day | 2010 |
| HourEnding | Utf8 | Hour ending time | 2010 |
| AncillaryType | Utf8 | Service type code | 2010 |
| MCPC | Float64 | Market clearing price | 2010 |
| DSTFlag | Utf8 | Daylight saving flag | 2011 |
| datetime | Datetime | Computed timestamp | All |

### Ancillary Service Types
| Code | Service | Available From |
|------|---------|----------------|
| REGUP | Regulation Up | 2010 |
| REGDN | Regulation Down | 2010 |
| RRS | Responsive Reserve | 2010 |
| NSPIN | Non-Spinning Reserve | 2010 |
| ECRS | Emergency Contingency Reserve | 2022 |
| ECRSM | ECRS Make-Whole | 2022 |
| ECRSS | ECRS Self-Schedule | 2022 |

## 4. DAM Generation Resource Data (60-Day Disclosure)

**Location**: `/rollup_files/DAM_Gen_Resources/`  
**Files**: `2019.parquet` through `2025.parquet`  
**Granularity**: Hourly by resource  
**Record Count**: ~50M records/year

### Column Schema
| Column Name | Data Type | Description | Available From | BESS Relevant |
|------------|-----------|-------------|----------------|---------------|
| Delivery Date | Utf8 | Operating day | 2019 | ✓ |
| Hour Ending | Utf8 | Hour ending time | 2019 | ✓ |
| QSE Name | Utf8 | Qualified scheduling entity | 2019 | |
| DME Name | Utf8 | Market entity | 2019 | |
| Resource Name | Utf8 | Resource identifier | 2019 | ✓ |
| Resource Type | Utf8 | Type (PWRSTR for BESS) | 2019 | ✓ |
| Settlement Point | Utf8 | Settlement location | 2019 | ✓ |
| Awarded Quantity | Float64 | Energy award (MW) | 2019 | ✓ |
| RegUp | Float64 | Regulation up award | 2019 | ✓ |
| RegDown | Float64 | Regulation down award | 2019 | ✓ |
| RRS | Float64 | Responsive reserve award | 2019 | ✓ |
| NSPIN | Float64 | Non-spin award | 2019 | ✓ |
| ECRS | Float64 | Emergency reserve award | 2022 | ✓ |
| Maximum SOC | Float64 | Max state of charge | 2021 | ✓ |
| Minimum SOC | Float64 | Min state of charge | 2021 | ✓ |

### Notes
- Filter by `Resource Type = 'PWRSTR'` for BESS resources
- ECRS columns added in 2022
- SOC columns added in 2021 for storage resources

## 5. SCED Generation Resource Data (5-Minute Dispatch)

**Location**: `/rollup_files/SCED_Gen_Resources/`  
**Files**: `2019.parquet` through `2025.parquet`  
**Granularity**: 5-minute intervals by resource  
**Record Count**: ~200M records/year

### Column Schema
| Column Name | Data Type | Description | Available From | BESS Relevant |
|------------|-----------|-------------|----------------|---------------|
| SCED Timestamp | Datetime | Dispatch time | 2019 | ✓ |
| Resource Name | Utf8 | Resource identifier | 2019 | ✓ |
| Resource Type | Utf8 | Type (PWRSTR for BESS) | 2019 | ✓ |
| Base Point | Float64 | Dispatch instruction (MW) | 2019 | ✓ |
| Telemetered Output | Float64 | Actual output (MW) | 2019 | ✓ |
| Telemetered SOC | Float64 | Actual SOC (MWh) | 2021 | ✓ |
| HDL | Float64 | High dispatch limit | 2019 | ✓ |
| LDL | Float64 | Low dispatch limit | 2019 | ✓ |
| Resource Status | Utf8 | ON/OFF/STARTUP | 2019 | ✓ |
| Shadow Price | Float64 | Marginal price | 2019 | |
| LMP | Float64 | Locational marginal price | 2019 | |

### Notes
- 288 intervals per day (5-minute granularity)
- Telemetered SOC added in 2021
- Critical for RT revenue calculations

## 6. COP Adjustment Period Snapshots

**Location**: `/rollup_files/COP_Snapshots/`  
**Files**: `2014.parquet` through `2025.parquet`  
**Granularity**: Hourly snapshots  
**Record Count**: ~40M records/year

### Column Schema
| Column Name | Data Type | Description | Available From | BESS Relevant |
|------------|-----------|-------------|----------------|---------------|
| Delivery Date | Utf8 | Operating day | 2014 | ✓ |
| Hour Ending | Utf8 | Hour ending time | 2014 | ✓ |
| QSE Name | Utf8 | Scheduling entity | 2014 | |
| Resource Name | Utf8 | Resource identifier | 2014 | ✓ |
| Status | Utf8 | Operating status | 2014 | ✓ |
| High Sustained Limit | Float64 | Max sustainable output | 2014 | ✓ |
| Low Sustained Limit | Float64 | Min sustainable output | 2014 | ✓ |
| Reg Up | Float64 | Regulation up capability | 2014 | ✓ |
| Reg Down | Float64 | Regulation down capability | 2014 | ✓ |
| RRS | Float64 | Responsive reserve capability | 2014 | ✓ |
| NSPIN | Float64 | Non-spin capability | 2014 | ✓ |
| ECRS | Float64 | Emergency reserve capability | 2022 | ✓ |
| Maximum SOC | Float64 | Max state of charge | 2019 | ✓ |
| Minimum SOC | Float64 | Min state of charge | 2019 | ✓ |
| Hour Beginning Planned SOC | Float64 | Planned SOC | 2019 | ✓ |

### File Format Changes
- **Before Dec 13, 2022**: `CompleteCOP_MMDDYYYY.csv`
- **After Dec 13, 2022**: `60d_COP_Adjustment_Period_Snapshot-DD-MMM-YY.csv`
- Some 2014 files lack headers (automatically detected and handled)

## 7. Supplemental AS Market Offers

**Location**: `/rollup_files/SASM_AS_Offers/`  
**Files**: `2019.parquet` through `2025.parquet`  
**Granularity**: Daily by resource and AS type  
**Record Count**: ~5M records/year

### Column Schema
| Column Name | Data Type | Description | Available From |
|------------|-----------|-------------|----------------|
| Delivery Date | Date | Operating day | 2019 |
| Resource Name | Utf8 | Resource identifier | 2019 |
| AS Type | Utf8 | Ancillary service type | 2019 |
| Offer MW | Float64 | Offered capacity | 2019 |
| Offer Price | Float64 | Offer price $/MW | 2019 |
| Award MW | Float64 | Awarded capacity | 2019 |
| Clearing Price | Float64 | Market clearing price | 2019 |

## Schema Evolution Summary

### Major Schema Changes by Year

**2011**
- Added DSTFlag column to price files
- Improved datetime handling for DST transitions

**2019**
- First BESS resources appear in data
- SOC tracking columns introduced in COP files

**2021**
- Enhanced SOC tracking in DAM/SCED files
- Telemetered SOC added to real-time data

**2022**
- ECRS (Emergency Contingency Reserve) introduced
- Multiple ECRS-related columns added
- COP file naming convention changed (Dec 13)

**2023**
- Market maturation with 150+ BESS resources
- Schema stabilization

**2024**
- 275+ BESS resources active
- Consistent schema across all file types

## Data Quality Considerations

### Missing Data Handling
- Pre-2011: No DSTFlag (defaulted to 'N')
- Pre-2019: No BESS-specific columns
- Pre-2022: No ECRS columns
- 2014 COP files: Some lack headers (auto-detected)

### Type Consistency
- All price columns forced to Float64
- Hour Ending standardized to Utf8
- Resource names consistent across files
- Datetime columns computed for efficient queries

### Gap Detection
- Each directory contains `gaps_report.md` and `gaps_report.csv`
- Documents missing date ranges
- Useful for data quality assessment

## Query Optimization Tips

### For BESS Analysis
```python
# Filter at read time for efficiency
filters = [
    ('Resource Type', '=', 'PWRSTR'),
    ('Resource Name', 'in', bess_list)
]
df = pq.read_table('DAM_Gen_Resources/2024.parquet', filters=filters)
```

### For Time Range Queries
```python
# Use computed datetime column
filters = [
    ('datetime', '>=', pd.Timestamp('2024-10-01')),
    ('datetime', '<', pd.Timestamp('2024-11-01'))
]
```

### For Joins
```python
# Join on indexed columns
# Settlement Point <-> SettlementPointName
# Resource Name is consistent across files
```

## File Size Estimates

| Dataset | Year | CSV Size | Parquet Size | Compression |
|---------|------|----------|--------------|-------------|
| RT Prices | 2024 | ~15 GB | ~1.2 GB | 92% |
| DA Prices | 2024 | ~8 GB | ~600 MB | 93% |
| AS Prices | 2024 | ~500 MB | ~40 MB | 92% |
| DAM Gen | 2024 | ~8 GB | ~600 MB | 93% |
| SCED Gen | 2024 | ~25 GB | ~2 GB | 92% |
| COP Snapshots | 2024 | ~6 GB | ~500 MB | 92% |

## Conclusion

The Parquet file catalog represents a comprehensive, optimized storage solution for ERCOT market data. The columnar format, combined with efficient compression and schema evolution tracking, enables high-performance analytics while maintaining data integrity across years of market evolution. The consistent structure and comprehensive metadata facilitate both historical analysis and real-time market monitoring.